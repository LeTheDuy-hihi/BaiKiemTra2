@page
@model PickleballClubManagement.Pages.Admin.CourtsModel
@{
    ViewData["Title"] = "Qu·∫£n L√Ω S√¢n ƒê·∫•u";
}

<div class="page-header">
    <h1 class="page-title">üè∏ Qu·∫£n L√Ω S√¢n ƒê·∫•u</h1>
</div>

@if (!string.IsNullOrEmpty(Model.SuccessMessage))
{
    <div class="alert alert-success">
        ‚úÖ @Model.SuccessMessage
    </div>
}

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger">
        ‚ùå @Model.ErrorMessage
    </div>
}

<div class="grid" style="grid-template-columns: 1fr 2fr; gap: 2rem;">
    <!-- Form Th√™m/S·ª≠a S√¢n -->
    <div class="card">
        <div class="card-header">
            <h3 style="margin: 0;">üìù @(Model.EditingCourtId.HasValue ? "C·∫≠p Nh·∫≠t S√¢n" : "Th√™m S√¢n M·ªõi")</h3>
        </div>

        <form method="post" style="padding: 1.5rem;">
            <div class="form-group">
                <label for="name">T√™n S√¢n <span style="color: red;">*</span></label>
                <input type="text" id="name" name="InputCourt.Name" class="form-control" 
                       placeholder="V√≠ d·ª•: S√¢n 1, S√¢n 2..." required 
                       value="@Model.InputCourt.Name" />
                <span asp-validation-for="InputCourt.Name" class="validation-error"></span>
            </div>

            <div class="form-group">
                <label for="description">M√¥ T·∫£</label>
                <textarea id="description" name="InputCourt.Description" class="form-control" 
                          placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ s√¢n"
                          style="min-height: 100px;">@Model.InputCourt.Description</textarea>
            </div>

            @if (Model.EditingCourtId.HasValue)
            {
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="InputCourt.IsActive" value="true" 
                               @(Model.InputCourt.IsActive ? "checked" : "") />
                        K√≠ch Ho·∫°t S√¢n
                    </label>
                </div>
                <input type="hidden" name="EditingCourtId" value="@Model.EditingCourtId" />
                <button type="submit" asp-page-handler="Update" class="btn btn-primary" style="width: 100%;">
                    üíæ C·∫≠p Nh·∫≠t
                </button>
            }
            else
            {
                <button type="submit" asp-page-handler="Create" class="btn btn-primary" style="width: 100%;">
                    ‚ûï Th√™m S√¢n
                </button>
            }
        </form>
    </div>

    <!-- Danh S√°ch S√¢n -->
    <div>
        @if (Model.Courts.Any())
        {
            <div class="grid" style="grid-template-columns: 1fr;">
                @foreach (var court in Model.Courts)
                {
                    <div class="card">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4 style="margin: 0;">üè∏ @court.Name</h4>
                                <small style="color: var(--color-gray-700);">
                                    @(court.IsActive ? "‚úÖ ƒêang Ho·∫°t ƒê·ªông" : "‚ùå ƒê√£ V√¥ Hi·ªáu H√≥a")
                                </small>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-outline" 
                                        onclick="editCourt(@court.Id, '@court.Name', '@court.Description', @(court.IsActive ? "true" : "false"))">
                                    ‚úèÔ∏è S·ª≠a
                                </button>
                                <form method="post" asp-page-handler="Delete" asp-route-id="@court.Id" 
                                      style="display: inline;" 
                                      onsubmit="return confirm('X√°c nh·∫≠n x√≥a s√¢n n√†y?');">
                                    <button type="submit" class="btn btn-sm btn-danger">
                                        üóëÔ∏è X√≥a
                                    </button>
                                </form>
                            </div>
                        </div>
                        @if (!string.IsNullOrEmpty(court.Description))
                        {
                            <div style="padding: 1rem 0; color: var(--color-gray-700); font-size: 0.875rem;">
                                üìå @court.Description
                            </div>
                        }
                    </div>
                }
            </div>
        }
        else
        {
            <div class="card" style="text-align: center; padding: 2rem;">
                <div style="font-size: 2rem; margin-bottom: 1rem;">üèúÔ∏è</div>
                <p>Kh√¥ng c√≥ s√¢n n√†o</p>
            </div>
        }
    </div>
</div>

<script>
function editCourt(id, name, description, isActive) {
    document.getElementById("name").value = name;
    document.getElementById("description").value = description;
    document.querySelector("input[name='InputCourt.IsActive']").checked = isActive;
    document.querySelector("input[name='EditingCourtId']").value = id;
    
    // Scroll to form
    document.querySelector(".card").scrollIntoView({ behavior: "smooth" });
}
</script>
